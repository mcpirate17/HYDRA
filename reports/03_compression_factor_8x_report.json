{
  "timestamp": "2025-12-07 14:46:12",
  "model_config": {
    "dim": 768,
    "n_heads": 12,
    "n_kv_heads": 3,
    "compression_factor": 8,
    "use_convs": true,
    "use_qk_mean": true,
    "use_qk_norm": true,
    "use_rope": true
  },
  "speed_results": [
    {
      "forward_time_ms": 0.7425899995723739,
      "backward_time_ms": 2.3221799987368286,
      "total_time_ms": 3.0647699983092025,
      "throughput_samples_per_sec": 326.2887592059725,
      "batch_size": 1,
      "seq_len": 256,
      "flops": 119906304,
      "flops_per_sec": 39124079153.13413
    },
    {
      "forward_time_ms": 0.9149699995759875,
      "backward_time_ms": 1.8431900010909885,
      "total_time_ms": 2.758160000666976,
      "throughput_samples_per_sec": 362.560547523777,
      "batch_size": 1,
      "seq_len": 512,
      "flops": 290144256,
      "flops_per_sec": 105194860316.23892
    },
    {
      "forward_time_ms": 0.8767699968302622,
      "backward_time_ms": 1.9693900045240298,
      "total_time_ms": 2.846160001354292,
      "throughput_samples_per_sec": 1405.402366028851,
      "batch_size": 4,
      "seq_len": 256,
      "flops": 479625216,
      "flops_per_sec": 168516603343.3747
    },
    {
      "forward_time_ms": 1.0701299994252622,
      "backward_time_ms": 1.921360002597794,
      "total_time_ms": 2.991490002023056,
      "throughput_samples_per_sec": 1337.1263140759015,
      "batch_size": 4,
      "seq_len": 512,
      "flops": 1160577024,
      "flops_per_sec": 387959519575.57477
    }
  ],
  "memory_results": [
    {
      "peak_memory_mb": 20.85205078125,
      "activation_memory_mb": 20.025875091552734,
      "parameter_memory_mb": 0.8261756896972656,
      "allocated_memory_mb": 19.46728515625,
      "reserved_memory_mb": 26.0,
      "batch_size": 1,
      "seq_len": 256,
      "memory_per_sample_mb": 20.85205078125
    },
    {
      "peak_memory_mb": 25.576171875,
      "activation_memory_mb": 24.749996185302734,
      "parameter_memory_mb": 0.8261756896972656,
      "allocated_memory_mb": 21.71728515625,
      "reserved_memory_mb": 46.0,
      "batch_size": 1,
      "seq_len": 512,
      "memory_per_sample_mb": 25.576171875
    },
    {
      "peak_memory_mb": 32.4326171875,
      "activation_memory_mb": 31.606441497802734,
      "parameter_memory_mb": 0.8261756896972656,
      "allocated_memory_mb": 23.96728515625,
      "reserved_memory_mb": 48.0,
      "batch_size": 4,
      "seq_len": 256,
      "memory_per_sample_mb": 8.108154296875
    },
    {
      "peak_memory_mb": 45.3994140625,
      "activation_memory_mb": 44.573238372802734,
      "parameter_memory_mb": 0.8261756896972656,
      "allocated_memory_mb": 29.96728515625,
      "reserved_memory_mb": 76.0,
      "batch_size": 4,
      "seq_len": 512,
      "memory_per_sample_mb": 11.349853515625
    }
  ],
  "gradient_analysis": {
    "mean_grad_norm": 8272.310536193847,
    "max_grad_norm": 29084.701171875,
    "min_grad_norm": 49.19166564941406,
    "grad_norm_q": 3800.59716796875,
    "grad_norm_k": 5132.23046875,
    "grad_norm_v": 29084.701171875,
    "grad_norm_o": 12680.2451171875,
    "vanishing_gradient_detected": false,
    "exploding_gradient_detected": true
  },
  "learning_results": {
    "initial_loss": 1.0027902126312256,
    "final_loss": 1.0002530813217163,
    "loss_improvement": 0.0025300718457865372,
    "convergence_steps": 1,
    "gradient_flow_score": 2.5848439731920574,
    "learning_capacity_score": 49.75300718457866
  },
  "component_analysis": {
    "compression_effectiveness": {
      "compression_factor": 8,
      "param_reduction_ratio": 0.875,
      "latent_dim": 96,
      "original_dim": 768,
      "convolutions_enabled": true
    },
    "qk_mean_impact": {
      "enabled": true,
      "n_groups": 4
    },
    "head_reshaping_efficiency": {
      "n_heads": 12,
      "n_kv_heads": 3,
      "gqa_ratio": 4.0,
      "head_dim": 8,
      "kv_cache_reduction": 0.25
    },
    "normalization_stats": {
      "qk_norm_enabled": true,
      "key_temperature": 0.9338197112083435
    }
  },
  "optimization_recommendations": [
    "\u26a0\ufe0f  Backward pass is much slower than forward. Consider:\n   - Enabling gradient checkpointing in full model\n   - Using 16-bit precision (float16/bfloat16)\n   - Reducing attention computation with lower compression",
    "\u26a0\ufe0f  Exploding gradients detected. Fix with:\n   - Reduce learning rate\n   - Enable gradient clipping\n   - Use layer normalization before attention\n   - Decrease compression factor (too aggressive compression)",
    "\u26a0\ufe0f  Low learning capacity score. Suggestions:\n   - Reduce compression factor for better expressivity\n   - Increase number of attention heads\n   - Try different kernel sizes for convolutions\n   - Verify data preprocessing is correct"
  ]
}