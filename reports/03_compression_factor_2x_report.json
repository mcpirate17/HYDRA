{
  "timestamp": "2025-12-07 14:46:09",
  "model_config": {
    "dim": 768,
    "n_heads": 12,
    "n_kv_heads": 3,
    "compression_factor": 2,
    "use_convs": true,
    "use_qk_mean": true,
    "use_qk_norm": true,
    "use_rope": true
  },
  "speed_results": [
    {
      "forward_time_ms": 0.8852399972965941,
      "backward_time_ms": 2.097509999293834,
      "total_time_ms": 2.982749996590428,
      "throughput_samples_per_sec": 335.26108495284444,
      "batch_size": 1,
      "seq_len": 256,
      "flops": 479625216,
      "flops_per_sec": 160799670286.90237
    },
    {
      "forward_time_ms": 1.0407300025690347,
      "backward_time_ms": 2.071270003216341,
      "total_time_ms": 3.112000005785376,
      "throughput_samples_per_sec": 321.3367603280675,
      "batch_size": 1,
      "seq_len": 512,
      "flops": 1160577024,
      "flops_per_sec": 372936061003.34985
    },
    {
      "forward_time_ms": 1.1858100013341755,
      "backward_time_ms": 2.135420005652122,
      "total_time_ms": 3.3212300069862977,
      "throughput_samples_per_sec": 1204.3730761151414,
      "batch_size": 4,
      "seq_len": 256,
      "flops": 1918500864,
      "flops_per_sec": 577647696776.3092
    },
    {
      "forward_time_ms": 1.1251100018853322,
      "backward_time_ms": 2.126249996945262,
      "total_time_ms": 3.251359998830594,
      "throughput_samples_per_sec": 1230.2544170558372,
      "batch_size": 4,
      "seq_len": 512,
      "flops": 4642308096,
      "flops_per_sec": 1427805010109.5183
    }
  ],
  "memory_results": [
    {
      "peak_memory_mb": 31.14794921875,
      "activation_memory_mb": 26.366695404052734,
      "parameter_memory_mb": 4.781253814697266,
      "allocated_memory_mb": 27.93896484375,
      "reserved_memory_mb": 42.0,
      "batch_size": 1,
      "seq_len": 256,
      "memory_per_sample_mb": 31.14794921875
    },
    {
      "peak_memory_mb": 40.05029296875,
      "activation_memory_mb": 35.269039154052734,
      "parameter_memory_mb": 4.781253814697266,
      "allocated_memory_mb": 29.43896484375,
      "reserved_memory_mb": 68.0,
      "batch_size": 1,
      "seq_len": 512,
      "memory_per_sample_mb": 40.05029296875
    },
    {
      "peak_memory_mb": 53.66796875,
      "activation_memory_mb": 48.886714935302734,
      "parameter_memory_mb": 4.781253814697266,
      "allocated_memory_mb": 32.43896484375,
      "reserved_memory_mb": 62.0,
      "batch_size": 4,
      "seq_len": 256,
      "memory_per_sample_mb": 13.4169921875
    },
    {
      "peak_memory_mb": 80.8818359375,
      "activation_memory_mb": 76.10058212280273,
      "parameter_memory_mb": 4.781253814697266,
      "allocated_memory_mb": 38.43896484375,
      "reserved_memory_mb": 104.0,
      "batch_size": 4,
      "seq_len": 512,
      "memory_per_sample_mb": 20.220458984375
    }
  ],
  "gradient_analysis": {
    "mean_grad_norm": 11654.898374938964,
    "max_grad_norm": 34959.71875,
    "min_grad_norm": 102.48216247558594,
    "grad_norm_q": 4301.10498046875,
    "grad_norm_k": 5381.3408203125,
    "grad_norm_v": 33274.01953125,
    "grad_norm_o": 34959.71875,
    "vanishing_gradient_detected": false,
    "exploding_gradient_detected": true
  },
  "learning_results": {
    "initial_loss": 1.0032422542572021,
    "final_loss": 1.0016335248947144,
    "loss_improvement": 0.0016035302935317342,
    "convergence_steps": 1,
    "gradient_flow_score": 3.8546792194499826,
    "learning_capacity_score": 49.660353029353175
  },
  "component_analysis": {
    "compression_effectiveness": {
      "compression_factor": 2,
      "param_reduction_ratio": 0.5,
      "latent_dim": 384,
      "original_dim": 768,
      "convolutions_enabled": true
    },
    "qk_mean_impact": {
      "enabled": true,
      "n_groups": 4
    },
    "head_reshaping_efficiency": {
      "n_heads": 12,
      "n_kv_heads": 3,
      "gqa_ratio": 4.0,
      "head_dim": 32,
      "kv_cache_reduction": 0.25
    },
    "normalization_stats": {
      "qk_norm_enabled": true,
      "key_temperature": 0.9271287322044373
    }
  },
  "optimization_recommendations": [
    "\u26a0\ufe0f  Backward pass is much slower than forward. Consider:\n   - Enabling gradient checkpointing in full model\n   - Using 16-bit precision (float16/bfloat16)\n   - Reducing attention computation with lower compression",
    "\u26a0\ufe0f  Exploding gradients detected. Fix with:\n   - Reduce learning rate\n   - Enable gradient clipping\n   - Use layer normalization before attention\n   - Decrease compression factor (too aggressive compression)",
    "\u26a0\ufe0f  Low learning capacity score. Suggestions:\n   - Reduce compression factor for better expressivity\n   - Increase number of attention heads\n   - Try different kernel sizes for convolutions\n   - Verify data preprocessing is correct"
  ]
}