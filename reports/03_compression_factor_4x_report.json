{
  "timestamp": "2025-12-07 14:46:11",
  "model_config": {
    "dim": 768,
    "n_heads": 12,
    "n_kv_heads": 3,
    "compression_factor": 4,
    "use_convs": true,
    "use_qk_mean": true,
    "use_qk_norm": true,
    "use_rope": true
  },
  "speed_results": [
    {
      "forward_time_ms": 0.8296300016809255,
      "backward_time_ms": 1.9784900039667264,
      "total_time_ms": 2.808120005647652,
      "throughput_samples_per_sec": 356.11013702719754,
      "batch_size": 1,
      "seq_len": 256,
      "flops": 239812608,
      "flops_per_sec": 85399700695.7296
    },
    {
      "forward_time_ms": 1.0016900021582842,
      "backward_time_ms": 1.8079100089380518,
      "total_time_ms": 2.809600011096336,
      "throughput_samples_per_sec": 355.922549847154,
      "batch_size": 1,
      "seq_len": 512,
      "flops": 580288512,
      "flops_per_sec": 206537766838.0508
    },
    {
      "forward_time_ms": 1.0770299966679886,
      "backward_time_ms": 1.7588800023077056,
      "total_time_ms": 2.835909998975694,
      "throughput_samples_per_sec": 1410.481997469865,
      "batch_size": 4,
      "seq_len": 256,
      "flops": 959250432,
      "flops_per_sec": 338251366350.2977
    },
    {
      "forward_time_ms": 1.0144699976081029,
      "backward_time_ms": 1.778499997453764,
      "total_time_ms": 2.792969995061867,
      "throughput_samples_per_sec": 1432.1671937300553,
      "batch_size": 4,
      "seq_len": 512,
      "flops": 2321154048,
      "flops_per_sec": 831070169784.8295
    }
  ],
  "memory_results": [
    {
      "peak_memory_mb": 23.39306640625,
      "activation_memory_mb": 21.494625091552734,
      "parameter_memory_mb": 1.8984413146972656,
      "allocated_memory_mb": 21.67333984375,
      "reserved_memory_mb": 28.0,
      "batch_size": 1,
      "seq_len": 256,
      "memory_per_sample_mb": 23.39306640625
    },
    {
      "peak_memory_mb": 30.03271484375,
      "activation_memory_mb": 28.134273529052734,
      "parameter_memory_mb": 1.8984413146972656,
      "allocated_memory_mb": 23.92333984375,
      "reserved_memory_mb": 52.0,
      "batch_size": 1,
      "seq_len": 512,
      "memory_per_sample_mb": 30.03271484375
    },
    {
      "peak_memory_mb": 39.14208984375,
      "activation_memory_mb": 37.243648529052734,
      "parameter_memory_mb": 1.8984413146972656,
      "allocated_memory_mb": 26.17333984375,
      "reserved_memory_mb": 58.0,
      "batch_size": 4,
      "seq_len": 256,
      "memory_per_sample_mb": 9.7855224609375
    },
    {
      "peak_memory_mb": 57.85302734375,
      "activation_memory_mb": 55.954586029052734,
      "parameter_memory_mb": 1.8984413146972656,
      "allocated_memory_mb": 32.17333984375,
      "reserved_memory_mb": 72.0,
      "batch_size": 4,
      "seq_len": 512,
      "memory_per_sample_mb": 14.4632568359375
    }
  ],
  "gradient_analysis": {
    "mean_grad_norm": 9036.471118545533,
    "max_grad_norm": 31853.654296875,
    "min_grad_norm": 14.964054107666016,
    "grad_norm_q": 3767.900390625,
    "grad_norm_k": 4931.5859375,
    "grad_norm_v": 31853.654296875,
    "grad_norm_o": 21112.6796875,
    "vanishing_gradient_detected": false,
    "exploding_gradient_detected": true
  },
  "learning_results": {
    "initial_loss": 1.0023880004882812,
    "final_loss": 1.0011861324310303,
    "loss_improvement": 0.0011990048211625408,
    "convergence_steps": 1,
    "gradient_flow_score": 3.096049635815005,
    "learning_capacity_score": 49.61990048211626
  },
  "component_analysis": {
    "compression_effectiveness": {
      "compression_factor": 4,
      "param_reduction_ratio": 0.75,
      "latent_dim": 192,
      "original_dim": 768,
      "convolutions_enabled": true
    },
    "qk_mean_impact": {
      "enabled": true,
      "n_groups": 4
    },
    "head_reshaping_efficiency": {
      "n_heads": 12,
      "n_kv_heads": 3,
      "gqa_ratio": 4.0,
      "head_dim": 16,
      "kv_cache_reduction": 0.25
    },
    "normalization_stats": {
      "qk_norm_enabled": true,
      "key_temperature": 0.931437611579895
    }
  },
  "optimization_recommendations": [
    "\u26a0\ufe0f  Exploding gradients detected. Fix with:\n   - Reduce learning rate\n   - Enable gradient clipping\n   - Use layer normalization before attention\n   - Decrease compression factor (too aggressive compression)",
    "\u26a0\ufe0f  Low learning capacity score. Suggestions:\n   - Reduce compression factor for better expressivity\n   - Increase number of attention heads\n   - Try different kernel sizes for convolutions\n   - Verify data preprocessing is correct"
  ]
}