{
  "timestamp": "2025-12-07 14:46:15",
  "model_config": {
    "dim": 768,
    "n_heads": 12,
    "n_kv_heads": null,
    "compression_factor": null,
    "use_convs": null,
    "use_qk_mean": null,
    "use_qk_norm": null,
    "use_rope": true
  },
  "speed_results": [
    {
      "forward_time_ms": 0.5810600006952882,
      "backward_time_ms": 0.9074200002942234,
      "total_time_ms": 1.4884800009895116,
      "throughput_samples_per_sec": 671.8262921471703,
      "batch_size": 1,
      "seq_len": 256,
      "flops": 252444672,
      "flops_per_sec": 169598967962.0686
    },
    {
      "forward_time_ms": 0.5188399984035641,
      "backward_time_ms": 0.8614600024884567,
      "total_time_ms": 1.3803000008920208,
      "throughput_samples_per_sec": 724.4801849987311,
      "batch_size": 1,
      "seq_len": 512,
      "flops": 605552640,
      "flops_per_sec": 438710888653.67004
    },
    {
      "forward_time_ms": 0.4367500019725412,
      "backward_time_ms": 0.8402599982218817,
      "total_time_ms": 1.277010000194423,
      "throughput_samples_per_sec": 3132.3168960235284,
      "batch_size": 4,
      "seq_len": 256,
      "flops": 1009778688,
      "flops_per_sec": 790736711416.7177
    },
    {
      "forward_time_ms": 0.5970099969999865,
      "backward_time_ms": 1.164519996382296,
      "total_time_ms": 1.7615299933822826,
      "throughput_samples_per_sec": 2270.753274157808,
      "batch_size": 4,
      "seq_len": 512,
      "flops": 2422210560,
      "flops_per_sec": 1375060639954.9043
    }
  ],
  "memory_results": [
    {
      "peak_memory_mb": 30.7919921875,
      "activation_memory_mb": 25.9140625,
      "parameter_memory_mb": 4.8779296875,
      "allocated_memory_mb": 28.00634765625,
      "reserved_memory_mb": 50.0,
      "batch_size": 1,
      "seq_len": 256,
      "memory_per_sample_mb": 30.7919921875
    },
    {
      "peak_memory_mb": 41.5322265625,
      "activation_memory_mb": 36.654296875,
      "parameter_memory_mb": 4.8779296875,
      "allocated_memory_mb": 29.50634765625,
      "reserved_memory_mb": 48.0,
      "batch_size": 1,
      "seq_len": 512,
      "memory_per_sample_mb": 41.5322265625
    },
    {
      "peak_memory_mb": 57.06103515625,
      "activation_memory_mb": 52.18310546875,
      "parameter_memory_mb": 4.8779296875,
      "allocated_memory_mb": 32.50634765625,
      "reserved_memory_mb": 84.0,
      "batch_size": 4,
      "seq_len": 256,
      "memory_per_sample_mb": 14.2652587890625
    },
    {
      "peak_memory_mb": 87.61181640625,
      "activation_memory_mb": 82.73388671875,
      "parameter_memory_mb": 4.8779296875,
      "allocated_memory_mb": 38.50634765625,
      "reserved_memory_mb": 104.0,
      "batch_size": 4,
      "seq_len": 512,
      "memory_per_sample_mb": 21.9029541015625
    }
  ],
  "gradient_analysis": {
    "mean_grad_norm": 321040.081640625,
    "max_grad_norm": 779972.25,
    "min_grad_norm": 16017.818359375,
    "grad_norm_q": 18970.630859375,
    "grad_norm_k": 21505.583984375,
    "grad_norm_v": 779972.25,
    "grad_norm_o": 768734.125,
    "vanishing_gradient_detected": false,
    "exploding_gradient_detected": true
  },
  "learning_results": {
    "initial_loss": 1.3340944051742554,
    "final_loss": 1.011695384979248,
    "loss_improvement": 0.24166132211332025,
    "convergence_steps": 3,
    "gradient_flow_score": 1.4373550048722104,
    "learning_capacity_score": 72.66613221133203
  },
  "component_analysis": {
    "compression_effectiveness": {},
    "qk_mean_impact": {},
    "head_reshaping_efficiency": {
      "n_heads": 12,
      "n_kv_heads": 12,
      "gqa_ratio": 1.0,
      "head_dim": 64,
      "kv_cache_reduction": 1.0
    },
    "normalization_stats": {}
  },
  "optimization_recommendations": [
    "\u26a0\ufe0f  Exploding gradients detected. Fix with:\n   - Reduce learning rate\n   - Enable gradient clipping\n   - Use layer normalization before attention\n   - Decrease compression factor (too aggressive compression)"
  ]
}