{
  "timestamp": "2025-12-07 14:46:17",
  "model_config": {
    "dim": 768,
    "n_heads": 12,
    "n_kv_heads": 3,
    "compression_factor": 4,
    "use_convs": true,
    "use_qk_mean": true,
    "use_qk_norm": true,
    "use_rope": true
  },
  "speed_results": [
    {
      "forward_time_ms": 1.1308500077575445,
      "backward_time_ms": 2.8465100011089817,
      "total_time_ms": 3.977360008866526,
      "throughput_samples_per_sec": 251.42305392791974,
      "batch_size": 1,
      "seq_len": 256,
      "flops": 239812608,
      "flops_per_sec": 60294418273.779076
    },
    {
      "forward_time_ms": 1.2232900044182315,
      "backward_time_ms": 2.6974500011419877,
      "total_time_ms": 3.9207400055602193,
      "throughput_samples_per_sec": 255.05389252586102,
      "batch_size": 1,
      "seq_len": 512,
      "flops": 580288512,
      "flops_per_sec": 148004843773.6398
    },
    {
      "forward_time_ms": 1.3069499982520938,
      "backward_time_ms": 2.7346900023985654,
      "total_time_ms": 4.041640000650659,
      "throughput_samples_per_sec": 989.697251451402,
      "batch_size": 4,
      "seq_len": 256,
      "flops": 959250432,
      "flops_per_sec": 237341879000.9925
    },
    {
      "forward_time_ms": 1.3102200056891888,
      "backward_time_ms": 2.7329100033966824,
      "total_time_ms": 4.043130009085871,
      "throughput_samples_per_sec": 989.3325198574005,
      "batch_size": 4,
      "seq_len": 512,
      "flops": 2321154048,
      "flops_per_sec": 574098295821.2614
    }
  ],
  "memory_results": [
    {
      "peak_memory_mb": 34.9794921875,
      "activation_memory_mb": 33.525814056396484,
      "parameter_memory_mb": 1.4536781311035156,
      "allocated_memory_mb": 31.54345703125,
      "reserved_memory_mb": 50.0,
      "batch_size": 1,
      "seq_len": 256,
      "memory_per_sample_mb": 34.9794921875
    },
    {
      "peak_memory_mb": 41.8623046875,
      "activation_memory_mb": 40.408626556396484,
      "parameter_memory_mb": 1.4536781311035156,
      "allocated_memory_mb": 33.04345703125,
      "reserved_memory_mb": 54.0,
      "batch_size": 1,
      "seq_len": 512,
      "memory_per_sample_mb": 41.8623046875
    },
    {
      "peak_memory_mb": 53.35498046875,
      "activation_memory_mb": 51.901302337646484,
      "parameter_memory_mb": 1.4536781311035156,
      "allocated_memory_mb": 36.04345703125,
      "reserved_memory_mb": 64.0,
      "batch_size": 4,
      "seq_len": 256,
      "memory_per_sample_mb": 13.3387451171875
    },
    {
      "peak_memory_mb": 77.40283203125,
      "activation_memory_mb": 75.94915390014648,
      "parameter_memory_mb": 1.4536781311035156,
      "allocated_memory_mb": 42.04345703125,
      "reserved_memory_mb": 96.0,
      "batch_size": 4,
      "seq_len": 512,
      "memory_per_sample_mb": 19.3507080078125
    }
  ],
  "gradient_analysis": {
    "mean_grad_norm": 82970.99822998047,
    "max_grad_norm": 664723.0,
    "min_grad_norm": 1171.4010009765625,
    "grad_norm_q": 52328.5078125,
    "grad_norm_k": 64433.71484375,
    "grad_norm_v": 664723.0,
    "grad_norm_o": 301049.625,
    "vanishing_gradient_detected": false,
    "exploding_gradient_detected": true
  },
  "learning_results": {
    "initial_loss": 1.3349087238311768,
    "final_loss": 1.0241825580596924,
    "loss_improvement": 0.23276959532634334,
    "convergence_steps": 1,
    "gradient_flow_score": 2.843494944640359,
    "learning_capacity_score": 72.77695953263434
  },
  "component_analysis": {
    "compression_effectiveness": {
      "compression_factor": 4,
      "param_reduction_ratio": 0.75,
      "latent_dim": 192,
      "original_dim": 768,
      "convolutions_enabled": true
    },
    "qk_mean_impact": {
      "enabled": true,
      "n_groups": 4
    },
    "head_reshaping_efficiency": {
      "n_heads": 12,
      "n_kv_heads": 3,
      "gqa_ratio": 4.0,
      "head_dim": 16,
      "kv_cache_reduction": 0.25
    },
    "normalization_stats": {
      "qk_norm_enabled": true,
      "key_temperature": 0.9016631245613098
    }
  },
  "optimization_recommendations": [
    "\u26a0\ufe0f  Backward pass is much slower than forward. Consider:\n   - Enabling gradient checkpointing in full model\n   - Using 16-bit precision (float16/bfloat16)\n   - Reducing attention computation with lower compression",
    "\u26a0\ufe0f  Exploding gradients detected. Fix with:\n   - Reduce learning rate\n   - Enable gradient clipping\n   - Use layer normalization before attention\n   - Decrease compression factor (too aggressive compression)"
  ]
}