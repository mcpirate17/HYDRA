{
  "timestamp": "2025-12-07 14:46:07",
  "model_config": {
    "dim": null,
    "n_heads": null,
    "n_kv_heads": null,
    "compression_factor": null,
    "use_convs": null,
    "use_qk_mean": null,
    "use_qk_norm": null,
    "use_rope": null
  },
  "speed_results": [
    {
      "forward_time_ms": 1.1631000001216307,
      "backward_time_ms": 2.6608600019244477,
      "total_time_ms": 3.8239600020460784,
      "throughput_samples_per_sec": 261.50901146061466,
      "batch_size": 1,
      "seq_len": 256,
      "flops": 239812608,
      "flops_per_sec": 62713158053.87189
    },
    {
      "forward_time_ms": 1.354169996920973,
      "backward_time_ms": 2.269990000058897,
      "total_time_ms": 3.62415999697987,
      "throughput_samples_per_sec": 275.92600791171816,
      "batch_size": 1,
      "seq_len": 512,
      "flops": 580288512,
      "flops_per_sec": 160116692553.19116
    },
    {
      "forward_time_ms": 1.5427499951329082,
      "backward_time_ms": 2.673830001731403,
      "total_time_ms": 4.216579996864311,
      "throughput_samples_per_sec": 237.15902478872852,
      "batch_size": 1,
      "seq_len": 1024,
      "flops": 1563230208,
      "flops_per_sec": 370734151649.5612
    },
    {
      "forward_time_ms": 1.4450699964072555,
      "backward_time_ms": 2.349969994975254,
      "total_time_ms": 3.7950399913825095,
      "throughput_samples_per_sec": 1054.0073382844182,
      "batch_size": 4,
      "seq_len": 256,
      "flops": 959250432,
      "flops_per_sec": 252764248645.12454
    },
    {
      "forward_time_ms": 1.631689997157082,
      "backward_time_ms": 2.6883199985604733,
      "total_time_ms": 4.320009995717555,
      "throughput_samples_per_sec": 925.923783501709,
      "batch_size": 4,
      "seq_len": 512,
      "flops": 2321154048,
      "flops_per_sec": 537302934553.6168
    },
    {
      "forward_time_ms": 2.303579996805638,
      "backward_time_ms": 5.049689995939843,
      "total_time_ms": 7.353269992745481,
      "throughput_samples_per_sec": 543.9756739445555,
      "batch_size": 4,
      "seq_len": 1024,
      "flops": 6252920832,
      "flops_per_sec": 850359205927.2877
    },
    {
      "forward_time_ms": 1.6193300019949675,
      "backward_time_ms": 2.6366199977928773,
      "total_time_ms": 4.255949999787845,
      "throughput_samples_per_sec": 1879.7213314063354,
      "batch_size": 8,
      "seq_len": 256,
      "flops": 1918500864,
      "flops_per_sec": 450780874797.7856
    },
    {
      "forward_time_ms": 2.3062100022798404,
      "backward_time_ms": 4.482859995914623,
      "total_time_ms": 6.7890699981944636,
      "throughput_samples_per_sec": 1178.3646364122892,
      "batch_size": 8,
      "seq_len": 512,
      "flops": 4642308096,
      "flops_per_sec": 683791461457.1083
    },
    {
      "forward_time_ms": 3.4551400021882728,
      "backward_time_ms": 8.553300000494346,
      "total_time_ms": 12.008440002682619,
      "throughput_samples_per_sec": 666.1981071823521,
      "batch_size": 8,
      "seq_len": 1024,
      "flops": 12505841664,
      "flops_per_sec": 1041421005659.8746
    }
  ],
  "memory_results": [
    {
      "peak_memory_mb": 72.07470703125,
      "activation_memory_mb": 49.920406341552734,
      "parameter_memory_mb": 22.154300689697266,
      "allocated_memory_mb": 62.68505859375,
      "reserved_memory_mb": 100.0,
      "batch_size": 1,
      "seq_len": 256,
      "memory_per_sample_mb": 72.07470703125
    },
    {
      "peak_memory_mb": 107.521484375,
      "activation_memory_mb": 85.36718368530273,
      "parameter_memory_mb": 22.154300689697266,
      "allocated_memory_mb": 64.18505859375,
      "reserved_memory_mb": 116.0,
      "batch_size": 1,
      "seq_len": 512,
      "memory_per_sample_mb": 107.521484375
    },
    {
      "peak_memory_mb": 144.85546875,
      "activation_memory_mb": 122.70116806030273,
      "parameter_memory_mb": 22.154300689697266,
      "allocated_memory_mb": 67.18505859375,
      "reserved_memory_mb": 182.0,
      "batch_size": 1,
      "seq_len": 1024,
      "memory_per_sample_mb": 144.85546875
    },
    {
      "peak_memory_mb": 144.36083984375,
      "activation_memory_mb": 122.20653915405273,
      "parameter_memory_mb": 22.154300689697266,
      "allocated_memory_mb": 67.93505859375,
      "reserved_memory_mb": 182.0,
      "batch_size": 4,
      "seq_len": 256,
      "memory_per_sample_mb": 36.0902099609375
    },
    {
      "peak_memory_mb": 226.02294921875,
      "activation_memory_mb": 203.86864852905273,
      "parameter_memory_mb": 22.154300689697266,
      "allocated_memory_mb": 73.68505859375,
      "reserved_memory_mb": 248.0,
      "batch_size": 4,
      "seq_len": 512,
      "memory_per_sample_mb": 56.5057373046875
    },
    {
      "peak_memory_mb": 387.10888671875,
      "activation_memory_mb": 364.95458602905273,
      "parameter_memory_mb": 22.154300689697266,
      "allocated_memory_mb": 85.18505859375,
      "reserved_memory_mb": 430.0,
      "batch_size": 4,
      "seq_len": 1024,
      "memory_per_sample_mb": 96.7772216796875
    },
    {
      "peak_memory_mb": 224.7744140625,
      "activation_memory_mb": 202.62011337280273,
      "parameter_memory_mb": 22.154300689697266,
      "allocated_memory_mb": 73.68505859375,
      "reserved_memory_mb": 258.0,
      "batch_size": 8,
      "seq_len": 256,
      "memory_per_sample_mb": 28.0968017578125
    },
    {
      "peak_memory_mb": 387.1103515625,
      "activation_memory_mb": 364.95605087280273,
      "parameter_memory_mb": 22.154300689697266,
      "allocated_memory_mb": 85.18505859375,
      "reserved_memory_mb": 430.0,
      "batch_size": 8,
      "seq_len": 512,
      "memory_per_sample_mb": 48.3887939453125
    },
    {
      "peak_memory_mb": 711.791015625,
      "activation_memory_mb": 689.6367149353027,
      "parameter_memory_mb": 22.154300689697266,
      "allocated_memory_mb": 109.18505859375,
      "reserved_memory_mb": 790.0,
      "batch_size": 8,
      "seq_len": 1024,
      "memory_per_sample_mb": 88.973876953125
    }
  ],
  "gradient_analysis": {
    "mean_grad_norm": 40227.14983258928,
    "max_grad_norm": 195734.28125,
    "min_grad_norm": 276.6453857421875,
    "grad_norm_q": 7727.4658203125,
    "grad_norm_k": 9937.0634765625,
    "grad_norm_v": 69346.703125,
    "grad_norm_o": 45036.61328125,
    "vanishing_gradient_detected": false,
    "exploding_gradient_detected": true
  },
  "learning_results": {
    "initial_loss": 2.011815071105957,
    "final_loss": 1.683927059173584,
    "loss_improvement": 0.16298118798877026,
    "convergence_steps": 1,
    "gradient_flow_score": 1.5718365346445073,
    "learning_capacity_score": 65.79811879887703
  },
  "component_analysis": {
    "compression_effectiveness": {},
    "qk_mean_impact": {},
    "head_reshaping_efficiency": {},
    "normalization_stats": {}
  },
  "optimization_recommendations": [
    "\u26a0\ufe0f  Exploding gradients detected. Fix with:\n   - Reduce learning rate\n   - Enable gradient clipping\n   - Use layer normalization before attention\n   - Decrease compression factor (too aggressive compression)"
  ]
}