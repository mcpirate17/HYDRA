{
  "timestamp": "2025-12-07 14:46:43",
  "model_config": {
    "dim": 768,
    "n_heads": 12,
    "n_kv_heads": 3,
    "compression_factor": 4,
    "use_convs": true,
    "use_qk_mean": true,
    "use_qk_norm": true,
    "use_rope": true
  },
  "speed_results": [
    {
      "forward_time_ms": 22.04129000310786,
      "backward_time_ms": 48.62947999499738,
      "total_time_ms": 70.67076999810524,
      "throughput_samples_per_sec": 14.150121755102017,
      "batch_size": 1,
      "seq_len": 64,
      "flops": 50515968,
      "flops_per_sec": 714807097.7768373
    },
    {
      "forward_time_ms": 21.76055999880191,
      "backward_time_ms": 48.19136000878643,
      "total_time_ms": 69.95192000758834,
      "throughput_samples_per_sec": 14.2955332733043,
      "batch_size": 1,
      "seq_len": 128,
      "flops": 107323392,
      "flops_per_sec": 1534245121.3398805
    },
    {
      "forward_time_ms": 21.766160003608093,
      "backward_time_ms": 47.93424000963569,
      "total_time_ms": 69.70040001324378,
      "throughput_samples_per_sec": 28.69423991282661,
      "batch_size": 2,
      "seq_len": 64,
      "flops": 101031936,
      "flops_per_sec": 1449517305.220672
    },
    {
      "forward_time_ms": 21.842049996485002,
      "backward_time_ms": 47.86551000433974,
      "total_time_ms": 69.70756000082474,
      "throughput_samples_per_sec": 28.69129259403624,
      "batch_size": 2,
      "seq_len": 128,
      "flops": 214646784,
      "flops_per_sec": 3079246842.0564485
    }
  ],
  "memory_results": [
    {
      "peak_memory_mb": 1193.537109375,
      "activation_memory_mb": 626.7577171325684,
      "parameter_memory_mb": 566.7793922424316,
      "allocated_memory_mb": 1192.60205078125,
      "reserved_memory_mb": 1448.0,
      "batch_size": 1,
      "seq_len": 64,
      "memory_per_sample_mb": 1193.537109375
    },
    {
      "peak_memory_mb": 1424.5341796875,
      "activation_memory_mb": 857.7547874450684,
      "parameter_memory_mb": 566.7793922424316,
      "allocated_memory_mb": 1192.97705078125,
      "reserved_memory_mb": 1516.0,
      "batch_size": 1,
      "seq_len": 128,
      "memory_per_sample_mb": 1424.5341796875
    },
    {
      "peak_memory_mb": 1424.5517578125,
      "activation_memory_mb": 857.7723655700684,
      "parameter_memory_mb": 566.7793922424316,
      "allocated_memory_mb": 1192.97705078125,
      "reserved_memory_mb": 1516.0,
      "batch_size": 2,
      "seq_len": 64,
      "memory_per_sample_mb": 712.27587890625
    },
    {
      "peak_memory_mb": 1622.8408203125,
      "activation_memory_mb": 1056.0614280700684,
      "parameter_memory_mb": 566.7793922424316,
      "allocated_memory_mb": 1193.72705078125,
      "reserved_memory_mb": 1682.0,
      "batch_size": 2,
      "seq_len": 128,
      "memory_per_sample_mb": 811.42041015625
    }
  ],
  "gradient_analysis": {
    "mean_grad_norm": 32219.310168549986,
    "max_grad_norm": 677699.4375,
    "min_grad_norm": 16.867780685424805,
    "grad_norm_q": 14457.36328125,
    "grad_norm_k": 16607.5859375,
    "grad_norm_v": 131975.796875,
    "grad_norm_o": 677699.4375,
    "vanishing_gradient_detected": false,
    "exploding_gradient_detected": true
  },
  "learning_results": {
    "initial_loss": 2.0006895065307617,
    "final_loss": 1.7379462718963623,
    "loss_improvement": 0.1313263414755138,
    "convergence_steps": 1,
    "gradient_flow_score": 1.8145437130477404,
    "learning_capacity_score": 62.63263414755138
  },
  "component_analysis": {
    "compression_effectiveness": {
      "compression_factor": 4,
      "param_reduction_ratio": 0.75,
      "latent_dim": 192,
      "original_dim": 768,
      "convolutions_enabled": true
    },
    "qk_mean_impact": {
      "enabled": true,
      "n_groups": 1
    },
    "head_reshaping_efficiency": {
      "n_heads": 12,
      "n_kv_heads": 3,
      "gqa_ratio": 4.0,
      "head_dim": 64,
      "kv_cache_reduction": 0.25
    },
    "normalization_stats": {
      "qk_norm_enabled": true
    }
  },
  "optimization_recommendations": [
    "\u26a0\ufe0f  Low compute throughput detected. Consider:\n   - Using Flash Attention for sequence attention\n   - Reducing kernel size for convolutions (from 3 to 1)\n   - Decreasing sequence length sampling for training",
    "\u26a0\ufe0f  Backward pass is much slower than forward. Consider:\n   - Enabling gradient checkpointing in full model\n   - Using 16-bit precision (float16/bfloat16)\n   - Reducing attention computation with lower compression",
    "\u26a0\ufe0f  High memory per sample. Consider:\n   - Increasing compression factor (current may be too low)\n   - Using mixed precision training (AMP)\n   - Reducing model width or using grouped query attention",
    "\u26a0\ufe0f  Exploding gradients detected. Fix with:\n   - Reduce learning rate\n   - Enable gradient clipping\n   - Use layer normalization before attention\n   - Decrease compression factor (too aggressive compression)"
  ]
}