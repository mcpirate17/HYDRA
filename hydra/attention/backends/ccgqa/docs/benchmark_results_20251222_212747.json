{
  "timestamp": "2025-12-22T21:27:47.521974",
  "gpu_info": {
    "name": "NVIDIA GeForce RTX 5090",
    "compute_capability": "12.0",
    "memory_gb": 33.7
  },
  "config": {
    "batch_size": 4,
    "n_heads": 8,
    "n_kv_heads": 2,
    "head_dim": 64,
    "dim": 512,
    "compression_factor": 4,
    "dtype": "torch.bfloat16",
    "warmup_iters": 20,
    "bench_iters": 50,
    "seq_lengths": [
      512,
      1024,
      2048,
      4096,
      8192
    ],
    "device": "cuda"
  },
  "results": [
    {
      "kernel": "CCGQA Original (Unfused)",
      "fwd_time_ms": 0.4615,
      "bwd_time_ms": 0.8203,
      "total_time_ms": 1.2818,
      "throughput_iters_per_sec": 780.1,
      "peak_memory_mb": 34.9,
      "fwd_memory_mb": 34.9,
      "bwd_memory_mb": 0.0,
      "success": true,
      "seq_len": 512
    },
    {
      "kernel": "CCGQA2 (Fused Path)",
      "fwd_time_ms": 0.4297,
      "bwd_time_ms": 0.8283,
      "total_time_ms": 1.258,
      "throughput_iters_per_sec": 794.9,
      "peak_memory_mb": 34.3,
      "fwd_memory_mb": 34.3,
      "bwd_memory_mb": 0.0,
      "success": true,
      "seq_len": 512
    },
    {
      "kernel": "GQA-Ref",
      "fwd_time_ms": 0.1337,
      "bwd_time_ms": 0.3011,
      "total_time_ms": 0.4348,
      "throughput_iters_per_sec": 2299.8,
      "peak_memory_mb": 99.1,
      "fwd_memory_mb": 92.8,
      "bwd_memory_mb": 6.3,
      "success": true,
      "seq_len": 512
    },
    {
      "kernel": "MHA-Ref",
      "fwd_time_ms": 0.1617,
      "bwd_time_ms": 0.3165,
      "total_time_ms": 0.4782,
      "throughput_iters_per_sec": 2091.2,
      "peak_memory_mb": 103.3,
      "fwd_memory_mb": 99.1,
      "bwd_memory_mb": 4.2,
      "success": true,
      "seq_len": 512
    },
    {
      "kernel": "PyTorch-SDPA",
      "fwd_time_ms": 0.0462,
      "bwd_time_ms": 0.0866,
      "total_time_ms": 0.1328,
      "throughput_iters_per_sec": 7530.7,
      "peak_memory_mb": 61.5,
      "fwd_memory_mb": 61.5,
      "bwd_memory_mb": 0.0,
      "success": true,
      "seq_len": 512
    },
    {
      "kernel": "FlashAttn-2",
      "fwd_time_ms": 0.0461,
      "bwd_time_ms": 0.1204,
      "total_time_ms": 0.1665,
      "throughput_iters_per_sec": 6005.6,
      "peak_memory_mb": 57.3,
      "fwd_memory_mb": 57.3,
      "bwd_memory_mb": 0.0,
      "success": true,
      "seq_len": 512
    },
    {
      "kernel": "CCGQA Original (Unfused)",
      "fwd_time_ms": 0.4721,
      "bwd_time_ms": 0.823,
      "total_time_ms": 1.2952,
      "throughput_iters_per_sec": 772.1,
      "peak_memory_mb": 60.2,
      "fwd_memory_mb": 62.1,
      "bwd_memory_mb": 0.0,
      "success": true,
      "seq_len": 1024
    },
    {
      "kernel": "CCGQA2 (Fused Path)",
      "fwd_time_ms": 0.4489,
      "bwd_time_ms": 0.8667,
      "total_time_ms": 1.3156,
      "throughput_iters_per_sec": 760.1,
      "peak_memory_mb": 57.1,
      "fwd_memory_mb": 59.0,
      "bwd_memory_mb": 0.0,
      "success": true,
      "seq_len": 1024
    },
    {
      "kernel": "GQA-Ref",
      "fwd_time_ms": 0.3483,
      "bwd_time_ms": 0.7247,
      "total_time_ms": 1.073,
      "throughput_iters_per_sec": 931.9,
      "peak_memory_mb": 315.2,
      "fwd_memory_mb": 269.0,
      "bwd_memory_mb": 46.1,
      "success": true,
      "seq_len": 1024
    },
    {
      "kernel": "MHA-Ref",
      "fwd_time_ms": 0.4151,
      "bwd_time_ms": 0.7733,
      "total_time_ms": 1.1884,
      "throughput_iters_per_sec": 841.5,
      "peak_memory_mb": 315.2,
      "fwd_memory_mb": 273.2,
      "bwd_memory_mb": 41.9,
      "success": true,
      "seq_len": 1024
    },
    {
      "kernel": "PyTorch-SDPA",
      "fwd_time_ms": 0.0855,
      "bwd_time_ms": 0.1806,
      "total_time_ms": 0.2661,
      "throughput_iters_per_sec": 3758.0,
      "peak_memory_mb": 97.3,
      "fwd_memory_mb": 97.3,
      "bwd_memory_mb": 0.0,
      "success": true,
      "seq_len": 1024
    },
    {
      "kernel": "FlashAttn-2",
      "fwd_time_ms": 0.0823,
      "bwd_time_ms": 0.2285,
      "total_time_ms": 0.3107,
      "throughput_iters_per_sec": 3218.0,
      "peak_memory_mb": 89.0,
      "fwd_memory_mb": 89.0,
      "bwd_memory_mb": 0.0,
      "success": true,
      "seq_len": 1024
    },
    {
      "kernel": "CCGQA Original (Unfused)",
      "fwd_time_ms": 0.5137,
      "bwd_time_ms": 1.0273,
      "total_time_ms": 1.541,
      "throughput_iters_per_sec": 648.9,
      "peak_memory_mb": 94.5,
      "fwd_memory_mb": 94.5,
      "bwd_memory_mb": 0.0,
      "success": true,
      "seq_len": 2048
    },
    {
      "kernel": "CCGQA2 (Fused Path)",
      "fwd_time_ms": 0.4957,
      "bwd_time_ms": 0.9708,
      "total_time_ms": 1.4665,
      "throughput_iters_per_sec": 681.9,
      "peak_memory_mb": 88.3,
      "fwd_memory_mb": 88.3,
      "bwd_memory_mb": 0.0,
      "success": true,
      "seq_len": 2048
    },
    {
      "kernel": "GQA-Ref",
      "fwd_time_ms": 1.4407,
      "bwd_time_ms": 2.8684,
      "total_time_ms": 4.3091,
      "throughput_iters_per_sec": 232.1,
      "peak_memory_mb": 1141.6,
      "fwd_memory_mb": 915.1,
      "bwd_memory_mb": 226.5,
      "success": true,
      "seq_len": 2048
    },
    {
      "kernel": "MHA-Ref",
      "fwd_time_ms": 1.5756,
      "bwd_time_ms": 2.9716,
      "total_time_ms": 4.5472,
      "throughput_iters_per_sec": 219.9,
      "peak_memory_mb": 1141.6,
      "fwd_memory_mb": 923.5,
      "bwd_memory_mb": 218.1,
      "success": true,
      "seq_len": 2048
    },
    {
      "kernel": "PyTorch-SDPA",
      "fwd_time_ms": 0.261,
      "bwd_time_ms": 0.5919,
      "total_time_ms": 0.8528,
      "throughput_iters_per_sec": 1172.6,
      "peak_memory_mb": 169.0,
      "fwd_memory_mb": 169.0,
      "bwd_memory_mb": 0.0,
      "success": true,
      "seq_len": 2048
    },
    {
      "kernel": "FlashAttn-2",
      "fwd_time_ms": 0.24,
      "bwd_time_ms": 0.5729,
      "total_time_ms": 0.8129,
      "throughput_iters_per_sec": 1230.1,
      "peak_memory_mb": 152.3,
      "fwd_memory_mb": 152.3,
      "bwd_memory_mb": 0.0,
      "success": true,
      "seq_len": 2048
    },
    {
      "kernel": "CCGQA Original (Unfused)",
      "fwd_time_ms": 0.7051,
      "bwd_time_ms": 1.5008,
      "total_time_ms": 2.2059,
      "throughput_iters_per_sec": 453.3,
      "peak_memory_mb": 165.5,
      "fwd_memory_mb": 165.8,
      "bwd_memory_mb": 0.0,
      "success": true,
      "seq_len": 4096
    },
    {
      "kernel": "CCGQA2 (Fused Path)",
      "fwd_time_ms": 0.6688,
      "bwd_time_ms": 1.4916,
      "total_time_ms": 2.1605,
      "throughput_iters_per_sec": 462.9,
      "peak_memory_mb": 152.0,
      "fwd_memory_mb": 153.2,
      "bwd_memory_mb": 0.0,
      "success": true,
      "seq_len": 4096
    },
    {
      "kernel": "GQA-Ref",
      "fwd_time_ms": 5.4107,
      "bwd_time_ms": 9.6712,
      "total_time_ms": 15.0819,
      "throughput_iters_per_sec": 66.3,
      "peak_memory_mb": 4405.0,
      "fwd_memory_mb": 3415.2,
      "bwd_memory_mb": 989.9,
      "success": true,
      "seq_len": 4096
    },
    {
      "kernel": "MHA-Ref",
      "fwd_time_ms": 5.5695,
      "bwd_time_ms": 9.7572,
      "total_time_ms": 15.3267,
      "throughput_iters_per_sec": 65.2,
      "peak_memory_mb": 4405.0,
      "fwd_memory_mb": 3431.9,
      "bwd_memory_mb": 973.1,
      "success": true,
      "seq_len": 4096
    },
    {
      "kernel": "PyTorch-SDPA",
      "fwd_time_ms": 0.7835,
      "bwd_time_ms": 1.943,
      "total_time_ms": 2.7265,
      "throughput_iters_per_sec": 366.8,
      "peak_memory_mb": 312.4,
      "fwd_memory_mb": 312.4,
      "bwd_memory_mb": 0.0,
      "success": true,
      "seq_len": 4096
    },
    {
      "kernel": "FlashAttn-2",
      "fwd_time_ms": 0.7697,
      "bwd_time_ms": 1.9015,
      "total_time_ms": 2.6711,
      "throughput_iters_per_sec": 374.4,
      "peak_memory_mb": 278.9,
      "fwd_memory_mb": 278.9,
      "bwd_memory_mb": 0.0,
      "success": true,
      "seq_len": 4096
    },
    {
      "kernel": "CCGQA Original (Unfused)",
      "fwd_time_ms": 1.3869,
      "bwd_time_ms": 3.3887,
      "total_time_ms": 4.7757,
      "throughput_iters_per_sec": 209.4,
      "peak_memory_mb": 297.5,
      "fwd_memory_mb": 297.5,
      "bwd_memory_mb": 0.0,
      "success": true,
      "seq_len": 8192
    },
    {
      "kernel": "CCGQA2 (Fused Path)",
      "fwd_time_ms": 1.3808,
      "bwd_time_ms": 3.3425,
      "total_time_ms": 4.7233,
      "throughput_iters_per_sec": 211.7,
      "peak_memory_mb": 272.6,
      "fwd_memory_mb": 272.6,
      "bwd_memory_mb": 0.0,
      "success": true,
      "seq_len": 8192
    },
    {
      "kernel": "GQA-Ref",
      "fwd_time_ms": 19.9492,
      "bwd_time_ms": 36.966,
      "total_time_ms": 56.9151,
      "throughput_iters_per_sec": 17.6,
      "peak_memory_mb": 17374.3,
      "fwd_memory_mb": 13247.1,
      "bwd_memory_mb": 4127.2,
      "success": true,
      "seq_len": 8192
    },
    {
      "kernel": "MHA-Ref",
      "fwd_time_ms": 20.7233,
      "bwd_time_ms": 37.649,
      "total_time_ms": 58.3723,
      "throughput_iters_per_sec": 17.1,
      "peak_memory_mb": 17374.3,
      "fwd_memory_mb": 13280.7,
      "bwd_memory_mb": 4093.6,
      "success": true,
      "seq_len": 8192
    },
    {
      "kernel": "PyTorch-SDPA",
      "fwd_time_ms": 2.8465,
      "bwd_time_ms": 7.2056,
      "total_time_ms": 10.0521,
      "throughput_iters_per_sec": 99.5,
      "peak_memory_mb": 599.2,
      "fwd_memory_mb": 599.2,
      "bwd_memory_mb": 0.0,
      "success": true,
      "seq_len": 8192
    },
    {
      "kernel": "FlashAttn-2",
      "fwd_time_ms": 2.7872,
      "bwd_time_ms": 7.0868,
      "total_time_ms": 9.874,
      "throughput_iters_per_sec": 101.3,
      "peak_memory_mb": 532.1,
      "fwd_memory_mb": 532.1,
      "bwd_memory_mb": 0.0,
      "success": true,
      "seq_len": 8192
    }
  ]
}